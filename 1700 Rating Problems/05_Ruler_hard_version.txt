// Solution for Ruler hard version